{% extends extend %} 
{% block content %}
<div style="margin:30px 60px;padding:1px;border:0.2px solid #5bc0de;width:100%;">
<table class="table table-hover" style="table-layout:fixed; font-size:1.2em;margin-bottom:0px;"  align="center">
    <thead>
        <th>排行</th>
        <th>歌曲</th>
        <th>作者</th>
        <th>歌词</th>
        <th>操作</th>
    </thead>
    <tbody id='table-group'>
    {% for item in items %}   
<tr class="entry">
    <td class="list-no">
        <span>{{ forloop.counter }}</span>
    </td>
    <td class="song-main">
                    <a class="artist" href="http://{{ item.song_url }}" title="{{ item.song_name }}" target="_blank">{{ item.song_name }}</a>
    </td>
    <td class="song-author">
        <span>{{ item.song_author }}</span>
    </td>
    <td class="song-lyric" song-id = "{{ item.song_id }}">
        <a href="javascript:void(0)" onclick="song_lyric(this)">
            查看歌词
        </a>
    </td>
    <td class="action" song-id = "{{ item.song_id }}">
            <a class="artist" href="http://{{ item.song_url }}"  target="_blank">
            <button data-action="play" class="play" title="试听">试听</button></a>
            {% if user_grant == "custom" %}
            <button data-action="like" class="like" title="收藏" onclick="userLogin()">收藏</button>
            <button data-action="share" class="share" title="分享" onclick="userLogin()">分享</button>
            <button data-action="like" class="like" title="收藏" onclick="song_commits(this)">评论</button>
            {% else %}
            <button data-action="like" class="like" title="收藏" onclick="song_liked(this)">收藏</button>
            <button data-action="share" class="share" title="分享" onclick="song_share(this)">分享</button>
            <button data-action="like" class="like" title="收藏" onclick="song_commits(this)">评论</button>
            {% endif %}
    </td>
</tr>
{% endfor %}
</tbody>
</table>
</div>
<style>
    .user-orders {
        border-bottom: 6px solid #39b58b;
    }
    .table>tbody>tr>td {
        border-top:none; 
        border-bottom: 1px solid #ddd;
    }
    .table>tbody>tr:hover {
        background-color: #DBEEF5;
    }
    .admin-orders-his {
        border-right: 6px solid #39b58b;
    }
</style>
<script>
    (function () {
        $('.selectpicker').selectpicker();
        $("span[data-trigger='hover']").popover();
        $('.collapse').collapse()
    })()

    function song_lyric(elem) {
        var song_id = $(elem).parent().attr("song-id")
        var song_name = $(elem).parents(".entry").find(".artist").attr("title")
        var title = song_name+"的歌词" 
        var html = ""
        html += "<p>明天你好！</p>"
        dialogAlert(title, html);
    }
    function song_liked(elem) {
        var song_id = $(elem).parent().attr("song-id");
        data = { 'song_id': song_id };
        postRequest("/song_liked/", data, true, likedResult);
    }
    function likedResult(params) {
        if (params == true){
            $(".Dialog").remove();
                    alert("恭喜您收藏歌曲成功！");
                }else {
                    alert("收藏失败，请稍后重试！")
            }
    }

    function song_share(elem) {
            var html = ""
            var song_id = $(elem).parents(".action").attr('song-id')
            var song_name = $(elem).parents(".entry").find(".artist").attr("title")
            html +="<h3>您想要分享的歌曲是：<span id='song-name'>" + song_name + "</span></h3>";
            html += "<h5>想要分享给：</h5>";
            var commitInfo = httpGet("/share_html/");
            html += commitInfo;
            html += "<span id='song-id' style='display:none;'>" + song_id + "</span>";
            var title = "分享歌曲给其他人"
            dialogAlert(title, html);
            $(".bootstrap-dialog-message").css("height", "500px");
            $(".bootstrap-dialog-message").css("overflow", "scroll");
            $(".bootstrap-dialog-message").css("text-align", "left");
        }
</script>
{% endblock %}